!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist",n(n.s=112)}([function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.5.6"};"number"==typeof __e&&(__e=n)},,,function(e,t,n){e.exports=!n(16)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var o=n(7);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},,function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var o=n(9),r=n(18);e.exports=n(4)?function(e,t,n){return o.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var o=n(5),r=n(27),i=n(26),u=Object.defineProperty;t.f=n(4)?Object.defineProperty:function(e,t,n){if(o(e),t=i(t,!0),o(n),r)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var o=n(11);e.exports=function(e,t,n){if(o(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,r){return e.call(t,n,o,r)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var o=n(0),r=n(1),i=n(12),u=n(8),c=n(10),a=function(e,t,n){var s,f,l,p=e&a.F,d=e&a.G,v=e&a.S,h=e&a.P,y=e&a.B,g=e&a.W,b=d?r:r[t]||(r[t]={}),w=b.prototype,m=d?o:v?o[t]:(o[t]||{}).prototype;for(s in d&&(n=t),n)(f=!p&&m&&void 0!==m[s])&&c(b,s)||(l=f?m[s]:n[s],b[s]=d&&"function"!=typeof m[s]?n[s]:y&&f?i(l,o):g&&m[s]==l?function(e){var t=function(t,n,o){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,o)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):h&&"function"==typeof l?i(Function.call,l):l,h&&((b.virtual||(b.virtual={}))[s]=l,e&a.R&&w&&!w[s]&&u(w,s,l)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a},,function(e,t,n){var o=n(7),r=n(0).document,i=o(r)&&o(r.createElement);e.exports=function(e){return i?r.createElement(e):{}}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},,function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},,,,,,,,function(e,t,n){var o=n(7);e.exports=function(e,t){if(!o(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!o(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){e.exports=!n(4)&&!n(16)(function(){return 7!=Object.defineProperty(n(15)("div"),"a",{get:function(){return 7}}).a})},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(104),i=(o=r)&&o.__esModule?o:{default:o};function u(){4===this.readyState&&(200===this.status?console.log(this.response):console.log(this.statusText))}t.pulldata=function(e,t){var n=function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.push(("v="+Math.random()).replace(".","")),t.join("&")}(t||{}),o=new XMLHttpRequest;o.open("GET",e+"?"+n),o.onreadystatechange=u,o.responseType="json",o.setRequestHeader("Accept","application/json"),o.send(null)},t.pulldataPost=function(e,t){var n=new XMLHttpRequest;n.open("POST",e,!0),n.onreadystatechange=u,n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(t)},t.api_request=function(e,t,n){return fetch(e,{method:t,body:(0,i.default)(n),headers:{"Content-Type":"application/json"}}).then(function(e){if(console.log(e),e.ok)return e.text()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlBase64ToUnit8Array=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t),o=new Uint8Array(n.length),r=0,i=n.length;r<i;++r)o[r]=n.charCodeAt(r);return o},t.ab2str=function(e){var t=new TextDecoder("iso-8859-2"),n=new Uint8Array(e);return console.log(t.decode(n)),String.fromCharCode.apply(null,new Uint8Array(e))},t.notification=function(e){var t=e.title;if(e.useNative){var n=new Notification(t,{tag:"normal",icon:"/app/img/favicon.ico",body:"native!"});n.addEventListener("click",function(e){console.log(e)}),setTimeout(n.close.bind(n),3e3)}else navigator.serviceWorker.ready.then(function(e){e.showNotification(t,{icon:"/app/img/favicon.ico",body:"can u see?"})})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initDom=function(){},t.initDomWithoutPush=function(){var e=document.querySelector(".t-notification"),t=document.querySelector(".t-api"),n=document.querySelector(".t-api-no");e.addEventListener("click",function(e){(0,o.notification)({title:"test...",useNative:!0})}),t.addEventListener("click",function(e){(0,r.api_request)("/api_report","POST",{type:0,code:1,content:"tte"}).then(function(e){return console.log(e)})}),n.addEventListener("click",function(e){(0,r.api_request)("/list","POST",{type:0}).then(function(e){return console.log(e)})})};var o=n(45),r=n(44)},function(e,t,n){var o=n(1),r=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},function(e,t,n){e.exports={default:n(103),__esModule:!0}},function(e,t,n){var o=n(13);o(o.S+o.F*!n(4),"Object",{defineProperty:n(9).f})},function(e,t,n){n(105);var o=n(1).Object;e.exports=function(e,t,n){return o.defineProperty(e,t,n)}},function(e,t,n){e.exports={default:n(106),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var o,r=n(107),i=(o=r)&&o.__esModule?o:{default:o};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,i.default)(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}()},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=c(n(109)),r=c(n(108)),i=n(45),u=n(44);function c(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){var n=t.elAddTo;(0,o.default)(this,e),this.dfdPrompt=null,this.elAddTo=n}return(0,r.default)(e,[{key:"initSW",value:function(){if("serviceWorker"in navigator)return navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(function(e){return console.log("ServiceWorker登记成功，范围为",e.scope),e}).catch(function(e){console.log("ServiceWorker登记失败：",e)});alert("not support serviceWorker")}},{key:"initPush",value:function(){var e=this;"PushManager"in window?navigator.serviceWorker.ready.then(function(t){return e.subscribe(t)}):alert("not support PushManager")}},{key:"initNotification",value:function(){Notification.requestPermission().then(function(e){"granted"===e?navigator.serviceWorker.ready.then(function(e){return e.showNotification("ServiceWorker登记成功!",{icon:"/app/img/favicon.ico",body:"can u see?"})}):alert("not support Notification")})}},{key:"initAddToScreen",value:function(){var e=this,t=document.querySelector(this.elAddTo);function n(e,n){"dismissed"===e.outcome?(console.log("用户取消安装应用"),!this.dfdPrompt&&n&&(this.dfdPrompt=n),t.style.display="block"):(console.log("用户安装了应用"),this.dfdPrompt=null,t.style.display="none")}window.addEventListener("beforeinstallprompt",function(e){e.userChoice.then(function(t){return n(t,e)})}),t.addEventListener("click",function(){null!=e.dfdPrompt&&(e.dfdPrompt.prompt(),e.dfdPrompt.userChoice.then(function(e){return n(e)}))})}},{key:"subscribe",value:function(e){console.log("browser subscribe"),e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(0,i.urlBase64ToUnit8Array)("BKmzm3addDa0_hQNkJ0Readn9V2-mIhtdNvfq_yOzYpY14hGhSGJ5ZD4flqSCBDEwlwxjiaLHparbg2n0h0gxOU")}).then(function(e){return(0,u.api_request)("http://localhost:8083/api_set","post",{endpoint:e.endpoint,p256dh:e.toJSON().keys.p256dh,auth:e.toJSON().keys.auth})}).catch(function(e){"denied"===Notification.permission&&console.log("用户拒绝了订阅请求")}),e.pushManager.getSubscription().then(function(e){console.log({uns:e}),e&&e.unsubscribe().then(function(e){console.log("已取消订阅")}).catch(function(e){})})}}]),e}();t.default=a},function(e,t){},function(e,t,n){"use strict";n(111);var o,r=n(110),i=(o=r)&&o.__esModule?o:{default:o},u=n(102);window.addEventListener("load",function(){var e=new i.default({elAddTo:"#btn-add"});e.initSW(),e.initPush(),e.initNotification(),e.initAddToScreen(),(0,u.initDom)()})}]);